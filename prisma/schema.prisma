// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model nguoi_dungs {
  id                Int                 @id @default(autoincrement())
  ho_va_ten         String
  email             String              @unique
  so_dien_thoai     String?
  mat_khau          String
  vai_tro           String              // admin, tinh_nguyen_vien, nguoi_dan
  hinh_anh          String?
  vi_do             Decimal?            @db.Decimal(10, 8)
  kinh_do           Decimal?            @db.Decimal(11, 8)
  yeu_cau_cuu_tros  yeu_cau_cuu_tros[]
  phan_phois        phan_phois[]        @relation("PhanPhoiTinhNguyenVien")
  created_at        DateTime            @default(now())
  updated_at        DateTime            @updatedAt
}

model yeu_cau_cuu_tros {
  id             Int          @id @default(autoincrement())
  id_nguoi_dung  Int
  loai_yeu_cau   String
  mo_ta          String?
  so_nguoi       Int
  do_uu_tien     String
  vi_do          Decimal?     @db.Decimal(10, 8)
  kinh_do        Decimal?     @db.Decimal(11, 8)
  trang_thai     String
  nguoi_dung     nguoi_dungs  @relation(fields: [id_nguoi_dung], references: [id])
  phan_phois     phan_phois[]
  created_at     DateTime     @default(now())
  updated_at     DateTime     @updatedAt
}
model trung_tam_cuu_tros {
  id             Int          @id @default(autoincrement())
  ten_trung_tam  String
  dia_chi        String
  vi_do          Decimal?     @db.Decimal(10, 8)
  kinh_do        Decimal?     @db.Decimal(11, 8)
  nguoi_quan_ly  String?
  so_lien_he     String?
  nguon_lucs     nguon_lucs[]
  created_at     DateTime     @default(now())
}

model nguon_lucs {
  id             Int                 @id @default(autoincrement())
  ten_nguon_luc  String
  loai           String
  so_luong       Int
  don_vi         String
  id_trung_tam   Int
  trung_tam      trung_tam_cuu_tros  @relation(fields: [id_trung_tam], references: [id])
  phan_phois     phan_phois[]
  created_at     DateTime            @default(now())
}

model phan_phois {
  id                   Int                     @id @default(autoincrement())
  id_yeu_cau           Int
  id_nguon_luc         Int
  id_tinh_nguyen_vien  Int
  trang_thai           String
  ma_giao_dich         String?
  thoi_gian_xuat       DateTime?
  thoi_gian_giao       DateTime?
  yeu_cau              yeu_cau_cuu_tros        @relation(fields: [id_yeu_cau], references: [id])
  nguon_luc            nguon_lucs              @relation(fields: [id_nguon_luc], references: [id])
  tinh_nguyen_vien     nguoi_dungs             @relation("PhanPhoiTinhNguyenVien", fields: [id_tinh_nguyen_vien], references: [id])
  nhat_ky_blockchains  nhat_ky_blockchains[]
}

model nhat_ky_blockchains {
  id            Int         @id @default(autoincrement())
  id_phan_phoi  Int
  ma_giao_dich  String
  hanh_dong     String
  du_lieu       Json
  thoi_gian     DateTime    @default(now())
  phan_phoi     phan_phois  @relation(fields: [id_phan_phoi], references: [id])
}

model du_bao_ais {
  id                        Int      @id @default(autoincrement())
  tinh_thanh                String
  loai_thien_tai            String
  du_doan_nhu_cau_thuc_pham Int
  du_doan_nhu_cau_nuoc      Int
  du_doan_nhu_cau_thuoc     Int
  du_doan_nhu_cau_cho_o     Int
  ngay_du_bao               DateTime
  created_at                DateTime @default(now())
}


